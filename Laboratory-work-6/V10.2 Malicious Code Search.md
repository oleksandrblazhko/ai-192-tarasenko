# V10.2 Пошук шкідливого коду

Шкідливий код надзвичайно рідкісний і його важко виявити. Перегляд коду вручну рядок за рядком може допомогти в пошуку логічних бомб, але навіть найдосвідченішому рецензенту коду буде важко знайти шкідливий код, навіть якщо він знає про його існування.
Дотримання вимог цього розділу неможлива без повного доступу до вихідного коду, включаючи бібліотеки сторонніх розробників.

|#| Опис | L1 | L2 | L3 | CWE |
|- |:-:|:-:|:-:|:-:|:-:|
| 10.2.1 | Переконайтеся, що вихідний код програми та бібліотеки сторонніх розробників не містять несанкціонованих можливостей домашнього телефону або збору даних. Якщо така функція існує, перш ніж збирати будь-які дані, отримайте дозвіл користувача на її роботу |  | ✓ | ✓ |359 |
| 10.2.2 |Переконайтеся, що програма не запитує непотрібних або надмірних дозволів на функції або датчики, пов’язані з конфіденційністю, наприклад контакти, камери, мікрофони або місцезнаходження. |  | ✓ | ✓ |272 | 
| 10.2.3 | Переконайтеся, що вихідний код програми та бібліотеки сторонніх розробників не містять бекдорів, таких як жорстко закодовані або додаткові незадокументовані облікові записи чи ключі, обфускація коду, недокументовані двійкові блоки, руткіти або засоби захисту від налагодження, незахищені функції налагодження, незахищена або прихована функція, яка може бути використана зловмисно, якщо її буде виявлено. |  |  | ✓ |507 | 
| 10.2.4 | Переконайтеся, що вихідний код програми та сторонні бібліотеки не містять бомб уповільненої дії, виконавши пошук функцій, пов’язаних із датою та часом. |  |  |✓ | 511|
| 10.2.5 | Переконайтеся, що вихідний код програми та бібліотеки сторонніх розробників не містять зловмисного коду, наприклад салямі-атак, логічних обходів або логічних бомб. |  |  | ✓|511 |
| 10.2.6 | Переконайтеся, що вихідний код програми та сторонні бібліотеки не містять пасхалок або будь-яких інших потенційно небажаних функцій. |  |  | ✓|507|

## CWE-359: Розкриття приватної особистої інформації несанкціонованому учаснику

### Опис

Продукт належним чином не запобігає доступу до приватної особистої інформації людини суб’єктам, які або не мають прямого дозволу на доступ до інформації, або не мають неявної згоди особи, про яку збирається інформація.

### Розширений опис

Існує багато типів конфіденційної інформації, яку продукти повинні захищати від зловмисників, зокрема системні дані, комунікації, конфігурація, комерційна таємниця, інтелектуальна власність і особиста (приватна) інформація. Конфіденційна особиста інформація може включати пароль, номер телефону, географічне розташування, особисті повідомлення, номер кредитної картки тощо. Важливо враховувати, чи є особа користувачем продукту чи частиною набору даних, який обробляється продукт. Розголошення приватної інформації не обов’язково перешкоджає належній роботі продукту, і насправді розголошення може бути навмисним розробником, напр. в рамках обміну даними з іншими організаціями. Однак розголошення особистої приватної інформації все одно може бути небажаним або прямо забороненим законом чи нормативним актом.

Деякі типи приватної інформації включають:

+ Державні ідентифікатори, як-от номери соціального страхування
+ Контактна інформація, наприклад домашні адреси та номери телефонів
+ Географічне розташування - де знаходиться (або був) користувач
+ Трудова книжка
+ Фінансові дані, такі як номери кредитних карток, зарплата, банківські рахунки та борги
+ Зображення, відео або аудіо
+ Моделі поведінки - наприклад, історія веб-серфінгу, коли виконуються певні дії тощо.
+ Відносини (і типи взаємин) з іншими – родина, друзі, контакти тощо.
+ Спілкування - адреси електронної пошти, приватні повідомлення, текстові повідомлення, журнали чатів тощо.
+ Здоров’я – медичні умови, страховий статус, записи про рецепти
+ Паролі облікових записів та інші облікові дані

Частина цієї інформації може бути охарактеризована як PII (Інформація, що дозволяє ідентифікувати особу), Захищена інформація про здоров’я (PHI) тощо. Категорії приватної інформації можуть збігатися або відрізнятися залежно від передбачуваного використання або політики та практики певної галузі.

Іноді дані, які не позначені як приватні, можуть мати наслідки для конфіденційності в іншому контексті. Наприклад, ідентифікаційні номери студентів зазвичай не вважаються конфіденційними, оскільки немає чіткого та загальнодоступного зіставлення з особистою інформацією окремого студента. Однак, якщо школа генерує ідентифікаційні номери на основі номерів соціального страхування учнів, тоді ідентифікаційні номери слід вважати приватними.

### Застосовні платформи

#### Мови

Клас: не залежить від мови (поширеність не визначена)

#### Технології

Клас: мобільний (поширеність не визначена)

### Загальні наслідки

|Область застосування |Вплив |
|- |:-:|
|Конфіденційність| Технічний вплив: читання даних програми|

### Ймовірність експлойту

Висока

## CWE-272: Найменше порушення привілеїв

### Опис

Підвищений рівень привілеїв, необхідний для виконання таких операцій, як chroot(), слід скинути одразу після виконання операції.

### Застосовні платформи

#### Мови

Клас: не залежить від мови (поширеність не визначена)


### Загальні наслідки

|Область застосування |Вплив |
|- |:-:|
|Конфіденційність, Управління доступом| Технічний вплив: отримання привілеїв або ідентифікації, читання даних програми, читання файлів або каталогів. Зловмисник може отримати доступ до ресурсів із підвищеними привілеями, до яких не можна було отримати доступ із початковими привілеями зловмисника. Це особливо ймовірно в поєднанні з іншою вадою, такою як переповнення буфера. |

## CWE-507: Троянський кінь

### Опис

Схоже, що продукт містить доброякісні або корисні функції, але він також містить код, прихований від нормальної роботи, який порушує намічену політику безпеки користувача або системного адміністратора.

### Загальні наслідки

|Область застосування |Вплив |
|- |:-:|
|Конфіденційність, Цілісність, Доступність| Технічний вплив: виконання несанкціонованого коду або команд.|

## CWE-511: Логічна бомба / Бомба сповільненої дії

### Опис

Продукт містить код, призначений для порушення законної роботи продукту (або його середовища) через певний час або коли виконується певна логічна умова.

### Розширений опис

Коли бомба сповільненої дії або логічна бомба підривається, вона може спричинити відмову в обслуговуванні, наприклад збій системи, видалення критичних даних або зниження часу відповіді системи. Ця бомба може бути розміщена в троянському коні, що реплікується, або не в троянському коні.

### Застосовні платформи

#### Мови

Клас: не залежить від мови (поширеність не визначена)

#### Технології

Клас: мобільний (поширеність не визначена)

### Загальні наслідки

|Область застосування |Вплив |
|- |:-:|
|Інша цілісність| Технічний вплив: залежить від контексту, зміна логіки виконання|

